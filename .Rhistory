selected = NULL,
multiple = TRUE,
width = "100%",
options = list(
'plugins' = list('remove_button'),
'create' = TRUE,
'persist' = TRUE
)
)
),
box(title = "Ivanti Ticket Number (if applicable)", status = "primary", solidHeader = TRUE,
id="box2", height = my_height,
textOutput("ticket_output" ))
),
spsComps::heightMatcher("box2", "box1"),
fluidRow(
box(title = "Enter Package Names", status = "info", solidHeader = TRUE,
id="box3", height = my_height,
selectizeInput(
inputId = "selectedPackages",
label = "Note: If package is not in exisiting choices please enter it's name exactly as it would be found in CRAN/MRAN",
#choices = packagesDF$Package,
choices = NULL,
selected = NULL,
multiple = TRUE,
width = "100%",
options = list(
'plugins' = list('remove_button'),
'create' = TRUE,
'persist' = TRUE
)
)
),
box(title = "Packages Selected", status = "info", solidHeader = TRUE,
id="box4", height = my_height,
textOutput("caption")),
spsComps::heightMatcher("box4", "box3")
),
fluidRow(
box(title = "Instructions & Resources:",width = 12, status = "success",  solidHeader = TRUE,
height = "20em",
HTML(paste0("<left>","<b>",'<font size="3">',"The following application will generate a validation report for package(s)","</left>","</b>","</font>","<br>")),
HTML(paste0("<left>","<b>",'<font size="3">',"The valueBoxes above identify the CRAN Snapshot, number of packages selected, and number of associated tickets.","</font>","</left>","</b>","<br>")),
HTML(paste0("<left>",'<font size="3">',"1. Begin by entering any ticket number(s) that are associated with the validation report","</font>","</left>","<br>")),
HTML(paste0("<left>",'<font size="3">',"2. Enter the name of package(s) that will be included in the report","<br>")),
HTML(paste0("<left>",'<font size="3">',"3. Click the 'Generate Report' button in the sidebar and a HTML report will be downloaded","</font>","</left>","<br>")),
HTML(paste0('<font size="3">',"   • ",a("Cran Snapshot", href = "https://cran.microsoft.com/snapshot/2021-11-08/",target="_blank"),"</font>","<br>")),
HTML(paste0('<font size="3">',"   • ",a("Riskmetric Github", href = "https://github.com/pharmaR/riskmetric",target="_blank"),"</font>","<br>")),
HTML(paste0('<font size="3">',"   • ",a("osyteR Github", href = "https://github.com/sonatype-nexus-community/oysteR",target="_blank"),"</font>"))
)
)
)
)
server <- function(input, output, session) {
updateSelectizeInput(session = session, inputId = 'selectedPackages',
choices = c(packagesDF$Package), server = TRUE)
output$caption <- renderText({
paste0(input$selectedPackages, collapse = ", ")
})
packages <- reactive({
input$selectedPackages
})
output$ticket_output <- renderText({
paste0(input$ticketnumbers, collapse = ",  ")
})
tickets <- reactive({
input$ticketnumbers
})
output$cranversion <- renderValueBox({
valueBox(
"CRAN",
"Snapshot 2021-11-08",
icon = icon("r-project")
)
})
output$packages_selected <- renderValueBox({
valueBox(
length(input$selectedPackages),
"Packages Selected",
color = "purple",
icon = icon("list-ol")
)
})
output$valuebox3 <- renderValueBox({
valueBox(
length(input$ticketnumbers),
"Number of Tickets",
color = "teal",
icon = icon("ticket-alt")
)
})
output$checkrender <- renderText({
if (identical(rmarkdown::metadata$runtime, "shiny")) {
TRUE
} else {
FALSE
}
})
output$btn <- downloadHandler(
filename = function(){paste0("PckgValidationReport", format(Sys.Date(),format="%m-%d-%Y"), ".html")},
content = function(file) {
withProgress(message = 'Rendering, please wait!', {
tempReport <- file.path(tempdir(),"validation_report.Rmd")
file.copy("validation_report.Rmd", tempReport, overwrite = TRUE)
rmarkdown::render("validation_report.Rmd", output_file = file,
params = list(pkg = packages(),
ticket = tickets(),
rendered_by_shiny = TRUE), # here I'm passing data in params
envir = new.env(parent = globalenv()),clean=F,encoding="utf-8"
)
})
}
)
}
# Run the application
shinyApp(ui = ui, server = server)
install.packages('prettydoc')
library(riskmetric)
install.packages('riskmetric')
options(repos=structure(c(CRAN="https://cran.r-project.org/")))
install.packages('riskmetric')
library(riskmetric)
library(riskmetric)
library(magrittr)
library(dplyr)
library(tidyverse)
library(tidyverse)
library(prettydoc)
library(dplyr)
library(oysteR)
require(data.table)
library(shiny)
library(shinydashboard)
mran_url <- 'https://mran.revolutionanalytics.com/snapshot/2021-11-08'
mran_pkg <- as.data.frame(available.packages(repos = mran_url))
packagesDF <- mran_pkg %>% select(Package)
my_height = "15em"
ui <- dashboardPage(
dashboardHeader(title = "Package Validation Report",
titleWidth = 300),
dashboardSidebar(
width = 300,
sidebarMenu(
div(style="text-align:center", br()),
div(style="text-align:center","Select Packages to Validate first:",br(), "then click the following button."),
div(style="text-align:center", br()),
div(style = "display:inline-block;width:100%;text-align: center;",
downloadButton("btn", label="Generate Report"),
icon = icon("paper-plane")),
div(style="text-align:center", br()),
div(style="text-align:center", br()),
HTML(paste0("<center>", "<b>", "About:", "</b>","</center>")),
HTML(paste0('<center>','<img src="https://www.pharmar.org/img/carousel/pharmaRlogo_smaller.png" style="height: 100px; width:100px;"/>' , '</center>')),
div(style="text-align:center", br()),
div(style="text-align:center","The riskmetric package is a collection of risk", br(), "metrics to evaluate the quality of R packages.", br() ,"The risk of using an R package is evaluated", br(), "based on a number of metrics meant to evaluate", br() , "development, best practices, code", br(), "documentation, community engagement,",br()," and development sustainability"),
div(style="text-align:center", br()),
HTML(paste0('<center>','<img src="https://raw.githubusercontent.com/sonatype-nexus-community/oysteR/master/man/figures/logo.png" style="height: 100px; width:100px;"/>' , '</center>')),
div(style="text-align:center", "The osyteR package scans", br(), "R packages with the 'OSS' Index", br(), "provided by 'Sonatype' and", br(), "reports any known vulnerabilities. "),
div(style="text-align:center", br()),
div(style="text-align:center", br()),
div(style="text-align:center", br()),
div(style="text-align:center", br()),
div(style="text-align:center", br())#,
#HTML(paste0('<center>','<img src="https://i.ibb.co/8jyykmR/procogia-vertical-light-bg-1.png" style="height: 100px; width:200px;"/>' , '</center>'))
)
),
dashboardBody(
fluidRow(
valueBoxOutput("cranversion"),
valueBoxOutput("packages_selected"),
valueBoxOutput("valuebox3")
),
fluidRow(
box(title = "Ticket Numbers", status = "primary", solidHeader = TRUE,
id="box1", height = my_height,
selectizeInput(
inputId = "ticketnumbers",
label = "Enter the Ivanti Ticket Number (if applicable)",
choices = "",
selected = NULL,
multiple = TRUE,
width = "100%",
options = list(
'plugins' = list('remove_button'),
'create' = TRUE,
'persist' = TRUE
)
)
),
box(title = "Ivanti Ticket Number (if applicable)", status = "primary", solidHeader = TRUE,
id="box2", height = my_height,
textOutput("ticket_output" ))
),
spsComps::heightMatcher("box2", "box1"),
fluidRow(
box(title = "Enter Package Names", status = "info", solidHeader = TRUE,
id="box3", height = my_height,
selectizeInput(
inputId = "selectedPackages",
label = "Note: If package is not in exisiting choices please enter it's name exactly as it would be found in CRAN/MRAN",
#choices = packagesDF$Package,
choices = NULL,
selected = NULL,
multiple = TRUE,
width = "100%",
options = list(
'plugins' = list('remove_button'),
'create' = TRUE,
'persist' = TRUE
)
)
),
box(title = "Packages Selected", status = "info", solidHeader = TRUE,
id="box4", height = my_height,
textOutput("caption")),
spsComps::heightMatcher("box4", "box3")
),
fluidRow(
box(title = "Instructions & Resources:",width = 12, status = "success",  solidHeader = TRUE,
height = "20em",
HTML(paste0("<left>","<b>",'<font size="3">',"The following application will generate a validation report for package(s)","</left>","</b>","</font>","<br>")),
HTML(paste0("<left>","<b>",'<font size="3">',"The valueBoxes above identify the CRAN Snapshot, number of packages selected, and number of associated tickets.","</font>","</left>","</b>","<br>")),
HTML(paste0("<left>",'<font size="3">',"1. Begin by entering any ticket number(s) that are associated with the validation report","</font>","</left>","<br>")),
HTML(paste0("<left>",'<font size="3">',"2. Enter the name of package(s) that will be included in the report","<br>")),
HTML(paste0("<left>",'<font size="3">',"3. Click the 'Generate Report' button in the sidebar and a HTML report will be downloaded","</font>","</left>","<br>")),
HTML(paste0('<font size="3">',"   • ",a("Cran Snapshot", href = "https://cran.microsoft.com/snapshot/2021-11-08/",target="_blank"),"</font>","<br>")),
HTML(paste0('<font size="3">',"   • ",a("Riskmetric Github", href = "https://github.com/pharmaR/riskmetric",target="_blank"),"</font>","<br>")),
HTML(paste0('<font size="3">',"   • ",a("osyteR Github", href = "https://github.com/sonatype-nexus-community/oysteR",target="_blank"),"</font>"))
)
)
)
)
server <- function(input, output, session) {
updateSelectizeInput(session = session, inputId = 'selectedPackages',
choices = c(packagesDF$Package), server = TRUE)
output$caption <- renderText({
paste0(input$selectedPackages, collapse = ", ")
})
packages <- reactive({
input$selectedPackages
})
output$ticket_output <- renderText({
paste0(input$ticketnumbers, collapse = ",  ")
})
tickets <- reactive({
input$ticketnumbers
})
output$cranversion <- renderValueBox({
valueBox(
"CRAN",
"Snapshot 2021-11-08",
icon = icon("r-project")
)
})
output$packages_selected <- renderValueBox({
valueBox(
length(input$selectedPackages),
"Packages Selected",
color = "purple",
icon = icon("list-ol")
)
})
output$valuebox3 <- renderValueBox({
valueBox(
length(input$ticketnumbers),
"Number of Tickets",
color = "teal",
icon = icon("ticket-alt")
)
})
output$checkrender <- renderText({
if (identical(rmarkdown::metadata$runtime, "shiny")) {
TRUE
} else {
FALSE
}
})
output$btn <- downloadHandler(
filename = function(){paste0("PckgValidationReport", format(Sys.Date(),format="%m-%d-%Y"), ".html")},
content = function(file) {
withProgress(message = 'Rendering, please wait!', {
tempReport <- file.path(tempdir(),"validation_report.Rmd")
file.copy("validation_report.Rmd", tempReport, overwrite = TRUE)
rmarkdown::render("validation_report.Rmd", output_file = file,
params = list(pkg = packages(),
ticket = tickets(),
rendered_by_shiny = TRUE), # here I'm passing data in params
envir = new.env(parent = globalenv()),clean=F,encoding="utf-8"
)
})
}
)
}
# Run the application
shinyApp(ui = ui, server = server)
library(shiny)
library(shinydashboard)
library(tidyverse)
mran_url <- 'https://mran.revolutionanalytics.com/snapshot/2021-11-08'
mran_pkg <- as.data.frame(available.packages(repos = mran_url))
packagesDF <- mran_pkg %>% select(Package)
my_height = "15em"
ui <- dashboardPage(
dashboardHeader(title = "Package Validation Report",
titleWidth = 300),
dashboardSidebar(
width = 300,
sidebarMenu(
div(style="text-align:center", br()),
div(style="text-align:center","Select Packages to Validate first:",br(), "then click the following button."),
div(style="text-align:center", br()),
div(style = "display:inline-block;width:100%;text-align: center;",
downloadButton("btn", label="Generate Report"),
icon = icon("paper-plane")),
div(style="text-align:center", br()),
div(style="text-align:center", br()),
HTML(paste0("<center>", "<b>", "About:", "</b>","</center>")),
HTML(paste0('<center>','<img src="https://www.pharmar.org/img/carousel/pharmaRlogo_smaller.png" style="height: 100px; width:100px;"/>' , '</center>')),
div(style="text-align:center", br()),
div(style="text-align:center","The riskmetric package is a collection of risk", br(), "metrics to evaluate the quality of R packages.", br() ,"The risk of using an R package is evaluated", br(), "based on a number of metrics meant to evaluate", br() , "development, best practices, code", br(), "documentation, community engagement,",br()," and development sustainability"),
div(style="text-align:center", br()),
HTML(paste0('<center>','<img src="https://raw.githubusercontent.com/sonatype-nexus-community/oysteR/master/man/figures/logo.png" style="height: 100px; width:100px;"/>' , '</center>')),
div(style="text-align:center", "The osyteR package scans", br(), "R packages with the 'OSS' Index", br(), "provided by 'Sonatype' and", br(), "reports any known vulnerabilities. "),
div(style="text-align:center", br()),
div(style="text-align:center", br()),
div(style="text-align:center", br()),
div(style="text-align:center", br()),
div(style="text-align:center", br())#,
#HTML(paste0('<center>','<img src="https://i.ibb.co/8jyykmR/procogia-vertical-light-bg-1.png" style="height: 100px; width:200px;"/>' , '</center>'))
)
),
dashboardBody(
fluidRow(
valueBoxOutput("cranversion"),
valueBoxOutput("packages_selected"),
valueBoxOutput("valuebox3")
),
fluidRow(
box(title = "Ticket Numbers", status = "primary", solidHeader = TRUE,
id="box1", height = my_height,
selectizeInput(
inputId = "ticketnumbers",
label = "Enter the Ivanti Ticket Number (if applicable)",
choices = "",
selected = NULL,
multiple = TRUE,
width = "100%",
options = list(
'plugins' = list('remove_button'),
'create' = TRUE,
'persist' = TRUE
)
)
),
box(title = "Ivanti Ticket Number (if applicable)", status = "primary", solidHeader = TRUE,
id="box2", height = my_height,
textOutput("ticket_output" ))
),
spsComps::heightMatcher("box2", "box1"),
fluidRow(
box(title = "Enter Package Names", status = "info", solidHeader = TRUE,
id="box3", height = my_height,
selectizeInput(
inputId = "selectedPackages",
label = "Note: If a package is not found that means it was published to CRAN/MRAN after the most recent MDRC snapshot",
#choices = packagesDF$Package,
choices = NULL,
selected = NULL,
multiple = TRUE,
width = "100%",
options = list(
'plugins' = list('remove_button')#,
#'create' = TRUE,
#'persist' = TRUE
)
)
),
box(title = "Packages Selected", status = "info", solidHeader = TRUE,
id="box4", height = my_height,
textOutput("caption")),
spsComps::heightMatcher("box4", "box3")
),
fluidRow(
box(title = "Instructions & Resources:",width = 12, status = "success",  solidHeader = TRUE,
height = "20em",
HTML(paste0("<left>","<b>",'<font size="3">',"The following application will generate a validation report for package(s)","</left>","</b>","</font>","<br>")),
HTML(paste0("<left>","<b>",'<font size="3">',"The valueBoxes above identify the CRAN Snapshot, number of packages selected, and number of associated tickets.","</font>","</left>","</b>","<br>")),
HTML(paste0("<left>",'<font size="3">',"1. Begin by entering any ticket number(s) that are associated with the validation report","</font>","</left>","<br>")),
HTML(paste0("<left>",'<font size="3">',"2. Enter the name of package(s) that will be included in the report","<br>")),
HTML(paste0("<left>",'<font size="3">',"3. Click the 'Generate Report' button in the sidebar and a HTML report will be downloaded","</font>","</left>","<br>")),
HTML(paste0('<font size="3">',"   • ",a("Cran Snapshot", href = "https://cran.microsoft.com/snapshot/2021-11-08/",target="_blank"),"</font>","<br>")),
HTML(paste0('<font size="3">',"   • ",a("Riskmetric Github", href = "https://github.com/pharmaR/riskmetric",target="_blank"),"</font>","<br>")),
HTML(paste0('<font size="3">',"   • ",a("osyteR Github", href = "https://github.com/sonatype-nexus-community/oysteR",target="_blank"),"</font>"))
)
)
)
)
server <- function(input, output, session) {
updateSelectizeInput(session = session, inputId = 'selectedPackages',
choices = c(packagesDF$Package), server = TRUE)
output$caption <- renderText({
paste0(input$selectedPackages, collapse = ", ")
})
packages <- reactive({
input$selectedPackages
})
output$ticket_output <- renderText({
paste0(input$ticketnumbers, collapse = ",  ")
})
tickets <- reactive({
input$ticketnumbers
})
output$cranversion <- renderValueBox({
valueBox(
"MRAN",
"Snapshot 2021-11-08",
icon = icon("r-project")
)
})
output$packages_selected <- renderValueBox({
valueBox(
length(input$selectedPackages),
"Packages Selected",
color = "purple",
icon = icon("list-ol")
)
})
output$valuebox3 <- renderValueBox({
valueBox(
length(input$ticketnumbers),
"Number of Tickets",
color = "teal",
icon = icon("ticket-alt")
)
})
output$checkrender <- renderText({
if (identical(rmarkdown::metadata$runtime, "shiny")) {
TRUE
} else {
FALSE
}
})
output$btn <- downloadHandler(
filename = function(){paste0("PckgValidationReport", format(Sys.Date(),format="%m-%d-%Y"), ".html")},
content = function(file) {
withProgress(message = 'Rendering, please wait!', {
tempReport <- file.path(tempdir(),"validation_report.Rmd")
file.copy("validation_report.Rmd", tempReport, overwrite = TRUE)
rmarkdown::render("validation_report.Rmd", output_file = file,
params = list(pkg = packages(),
ticket = tickets(),
rendered_by_shiny = TRUE), # here I'm passing data in params
envir = new.env(parent = globalenv()),clean=F,encoding="utf-8"
)
})
}
)
}
# Run the application
shinyApp(ui = ui, server = server)
knitr::opts_chunk$set(echo = TRUE)
library(riskmetric)
library(magrittr)
library(dplyr)
library(tidyverse)
library(prettydoc)
library(dplyr)
library(oysteR)
require(data.table)
library(adjustedcranlogs)
library(lubridate)
library(ggplot2)
package_list <- as.data.frame(c(params$pkg))
package_list <- package_list %>% filter(!`c(params$pkg)` %in% 'ggplot2') %>%
rename(name=`c(params$pkg)`)
mran_url <- paste0('https://mran.revolutionanalytics.com/snapshot/', params$snapshot_date)
mran_pkg <- available.packages(repos = mran_url)
mran_pkg <- mran_pkg[rownames(mran_pkg) %in% params$pkg, c("Package","Version")]
rownames(mran_pkg) <- NULL
mran_pkg <- as.data.frame(mran_pkg)
mran_pkg <- mran_pkg %>% filter(!Package == "ggplot2")
db <- tools::CRAN_package_db()
colnames(db)
View(mran_pkg)
mran_pkg <- available.packages(repos = mran_url)
mran_pkg <- mran_pkg[rownames(mran_pkg) %in% params$pkg, c("Package","Version")]
View(mran_pkg)
mran_pkg <- available.packages(repos = mran_url)
View(mran_pkg)
View(db)
View(db)
colnames(db)
mran_pkg <- available.packages(repos = mran_url)
mran_pkg <- available.packages(repos = mran_url)
mran_pkg <- mran_pkg[rownames(mran_pkg) %in% params$pkg, c("Package","Version")]
mran_pkg <- mran_pkg[rownames(mran_pkg) %in% params$pkg, c("Package","Version")]
rownames(mran_pkg) <- NULL
mran_pkg <- as.data.frame(mran_pkg)
mran_pkg <- mran_pkg %>% filter(!Package == "ggplot2")
db <- tools::CRAN_package_db()
colnames(db)
mran_pkg <- as.data.frame(mran_pkg)
mran_pkg <- mran_pkg %>% filter(!Package == "ggplot2")
db <- tools::CRAN_package_db()
colnames(db)
mdf <- data.frame(db[,1], db[,53],db[,17])
colnames(db)
mdf <- data.frame(db[,1], db[,53],db[,17])
colnames(mdf) <- c("Package", "Title", "Author")
tab1 <- left_join(mran_pkg, mdf, by = "Package")
View(tab1)
View(db)
